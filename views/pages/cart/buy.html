<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è´­ç¥¨é¡µé¢</title>
    <link rel="stylesheet" href="/views/static/css/cinema.css">
    <link rel="stylesheet" href="/views/static/css/styles.css">
    <link rel="stylesheet" href="/views/static/css/buy2.css">
    <script src="/views/static/script/jquery-1.7.2.js"></script>
</head>
<body>
<!-- å¤´éƒ¨åŒºåŸŸ -->
<header>
    <!--    <div><img  id="name" src="#" alt="ä½ çš„åå­—" width="100%"> </div>-->

    <div class="header-container">
        <div class="logo">
            <img src="logo.png" alt="ç½‘ç«™æ ‡å¿—">
        </div>
        <nav>
            <ul>
                <li><a href="/">é¦–é¡µ</a></li>
                <li><a href="/GetMovieByLimit">ç”µå½±</a></li>
                <li><a href="/GetCinemaByLimit">å½±é™¢</a></li>
                <li>
                    <div class="dropdown">
                        <span>æˆ‘çš„</span>
                        <div class="dropdown-content">
                            <a href="/GetGoods">æˆ‘çš„è®¢å•</a>
                            <a href="/logout" class="logout" onclick="alert1(this)">æ³¨é”€</a>
                        </div>
                    </div>
                </li>
            </ul>
        </nav>
    </div>
</header>

<main>
    <section class="cinema-info">
        <h1>ç”µå½±ç¥¨è´­ä¹°</h1>
        <div class="cinema">
            <h2>é€‰æ‹©åº§ä½</h2>
            <div class="screen">å±å¹•</div>
            <div class="seating-chart">
                <!--                éå†åº§ä½-->
                {{range $i, $row := . }}

                <div class="row">
                    {{range $j, $value := $row }}
                        {{if .}}

                    <div class="seat ban" data-seat="{{ $i }}-{{ $j }}" onclick="choose(this)">{{ $i }}-{{ $j }}</div>
                        {{else}}
                    <div class="seat available" data-seat="{{ $i }}-{{ $j }}" onclick="choose(this)">{{ $i }}-{{ $j }}</div>

                        {{end}}
                    {{end}}
                </div>
                {{end}}

                <div class="summary">
                    <button id="purchase-button" onclick="buy()">è´­ä¹°</button>
                </div>
            </div>
        </div>
    </section>
</main>

<script>
    // "seat available"  å¯é€‰
    //"seat ban"  ä¸å¯é€‰
    //"seat selected"  å·²é€‰
    var num = 0
    var arr = []

    function choose(a){
        // è·å–classå±æ€§ï¼Œå¹¶åˆ¤æ–­
        var Class = a.getAttribute('class');
        //è·å–åº§ä½ç¼–å·
        var data = a.getAttribute('data-seat');
        // alert(data)
        // alert(Class)
        if (Class === "seat available"){
            a.setAttribute('class','seat selected')
            arr.push(data)
            num++
        }
        if (Class === "seat selected"){
            a.setAttribute('class','seat available')
            arr = arr.filter(function (item){
                return item !== data
            })
            num--
        }
    }


    function buy(){
        if (num>0){
            confirm("ç¡®å®šè¦è´­ä¹°è¿™"+num+"å¼ ç¥¨å—ï¼ŸğŸ˜‹\n\n"+"åº§ä½ä¸ºï¼š"+arr)
            var url = new URL(window.location.href);

            // ä½¿ç”¨ URLSearchParams è·å–æŸ¥è¯¢å­—ç¬¦ä¸²
            var params = new URLSearchParams(url.search);

            //è·å–åˆ°è¿™ä¸ªåœºæ¬¡çš„id
            var id = params.get('playbackId')



            //alert(url2)
            // è§¦å‘ç‚¹å‡»äº‹ä»¶ï¼Œç›´æ¥å»æ–°è¿æ¥
            //åŠ é”åˆ¤æ–­è¯¥ä½ç½®æ˜¯å¦æœ‰ç¥¨
           window.location.href = '/Check?Id='+id+'&seat='+arr+'&num='+num;
        }else{
            alert("æ‚¨æ²¡æœ‰é€‰æ‹©ä»»ä½•ç¥¨ï¼")
        }
        // ä¹°ç¥¨è·³è½¬å‰åˆ¤æ–­æ˜¯å¦æœ‰ç¥¨

    }

</script>
<!-- åº•éƒ¨åŒºåŸŸ -->
<footer>
    <div class="footer-container">
        <div class="footer-links">
            <a href="#">å…³äºæˆ‘ä»¬</a>
            <a href="#">éšç§æ”¿ç­–</a>
        </div>
        <div class="social-icons">
            <a href="#"><img src="/views/static/img/facebook.png" alt="Facebook"></a>
            <a href="#"><img src="/views/static/img/twitter.png" alt="Twitter"></a>
            <a href="#"><img src="/views/static/img/instagram.png" alt="Instagram"></a>
        </div>
    </div>
</footer>
</body>
</html>

